## 操作系统的定义
> 操作系统(Operating System,OS)是指控制和管理整个计算机系统的硬件和软件资源,并合理地组织高度计算机的工作和资源的分配,以提供给用户和其他软件方便的接口和环境,它是计算机系统中最基本的系统软件.
> ![](assets/Screenshot%202022-02-05%20233650.png)

## 特征
### 并发
> 指两个或多个事件在同一时间间隔内发生.这些事件宏观上是同时发生的,但微观上是交替发生的.与**并行**不同,**并行**指两个或多个事件在同一时刻同时发生.  
> 操作系统的并发性指计算机系统中同时存在着多个运行着的程序.  
> 一个单核处理机(CPU)同一时刻只能执行一个程序,因此操作系统会负责协调多个程序交替执行(这此程序微观上是交替执行的,但宏观上看起来就像在同时执行)  
> 事实上,操作系统就是伴随着"多道程序技术"而出现的.因此,操作系统和程序并发是一起诞生的.  
> 当今的计算机,一般都是多核CPU,比如Intel的第八代i3处理器就是4核CPU,这意味着同一时刻可以有4个程序**并行**执行,但是操作系统的并发性依然必不可少,当代人使用计算机绝对有4个以上的程序需要同时工作.
### 共享
> 即资源共享,是指系统中的资源可供内存中多个并发执行的进程共同使用.
> + 互斥共享方式
>   > 系统中的某些资源,虽然可以提供给多个进程使用,但一个时间段内只允许一个进程访问资源.
> + 同时共享方式
>   > 系统中的某些资源,允许一个时间段内由多个进程"同时"对它们进行访问.所谓的"同时"往往是宏观上的,而在微观上,这此进程可能是交替地对该资源进行访问的(即分时共享),当然出可能出现微观上同时的情况,比如用扬声器同时放两首歌(但是我觉得只是两个进程了同一个内存区域了)

### 并发和共享的关系
![](assets/Screenshot%202022-02-06%20164836.png)

### 虚拟
> 虚拟是指把一个物理上的实体变为若干个逻辑上的对应物.物理实体(前者)是实现存在的,而逻辑上对应物(后者)是用户感觉到的.
> ![](assets/Screenshot%202022-02-06%20170037.png)


### 异步
> 在多道程序环境下,允许多个程序并发执行,但由于资源有限,进程的执行不是一贯到底的,而是走走停停,以不可预知的速度向前推进,这就是进程的异步性.

![](assets/Screenshot%202022-02-06%20171352.png)

## OS的发展阶段
![](assets/Screenshot%202022-02-07%20200105.png)
+ 手工操作阶段
  ![](assets/Screenshot%202022-02-07%20185140.png)
+ 单道批处理系统
  ![](assets/Screenshot%202022-02-07%20192252.png)
+ 多道批处理系统
  > 主要优点:多道程序并发执行,共享计算机资源.资源利用率大幅提升,CPU和其他资源保持"忙碌"状态,系统吞吐量增大.  
  > 主要缺点:用户响应时间长,没有人机交互功能(用户提交自己的作业之后就只能等待计算机处理完成,中间不能控制自己的作业执行)
  > ![](assets/Screenshot%202022-02-07%20192919.png)
+ 分时操作系统
  > 计算机以时间片为单位轮流为各个用户/作业服务,各个用户可通过终端与计算机进行交互.  
  > 主要优点:用户请求可以被即时响应,解决了人机交互问题.允许多个用户同时使用一个计算机,并且用户对计算机的操作相互独立,感受不到别人的存在.  
  > 主要缺点:不能优先处理一些紧急任务.操作系统对各个用户/作业都是完全公平的,循环地为每个用户/作业服务一个时间片,不区分任务的紧急性.  
  > ![](assets/Screenshot%202022-02-07%20194603.png)

+ 时间操作系统
  > 主要优点:能够优先响应一些紧急任务,某些紧急任务不需时间片排队.  
  > 在实时操作系统的控制下,计算机系统接收到外部信号后及时进行处理,并且要在严格的时限内处理完事件.实时操作系统的主要特点是及时性和可靠性.  
  > ![](assets/Screenshot%202022-02-07%20195504.png)

+ 其他
  1. 网络操作系统:是伴随着计算机网络的发展而诞生的,能把网络中各个计算机有机地结合起来,实现数据传送等功能,实现网络中各种资源的共享(如文件共享)和各台计算机之间的通信.(如:Windows NT 就是一种典型的网络操作系统,网站服务器就可以使用)
  2. 分布式操作系统:主要特点是分布性和并行性.系统中的各台计算机地位相同,任何工作都可以分布在这些计算机上,由它们并行,协同完成这个任务.
  3. 个人计算机操作系统:如Windows XP,MacOS,方便个人使用.

## 两种指令
> 处理器(CPU)能识别,执行的最基本命令,比如,加法指令就是让CPU进行加法运算.
+ 特权指令:不允许用户程序使用,如"内存清零指令"
+ 非特权指令:如普通的运算指令

## 两种处理器状态
> 用程序状态字寄存器(PSW)中的某标志位来标识当前处理器处于什么状态.如0为用户态,1为核心态
+ 用户态(目态):此时CPU只能执行非特权指令
+ 核心态(管态):特权指令,非特权指令都可执行

## 两种程序
+ 内核程度:操作系统的内核程序是系统的管理者,既可以执行特权指令,也可以执行非特权指令,运行在核心态.
+ 应用程序:为了保证系统能安全运行,普通应用程序只能执行非特权指令,运行在用户态.

## 操作系统的内核
> 内核是计算机上配置的底层软件,是操作系统最基本,最核心的部分.  
> 实现操作系统内核功能的那些程序就是内核程序
> ![](assets/Screenshot%202022-02-08%20192945.png)
> ![](assets/Screenshot%202022-02-08%20193254.png)

## 操作系统的体系结构D
+ 大内核
  > 将操作系统的主要功能模块都作为系统内核,运行在核心态
  + 优点:高性能
  + 缺点:内核代码庞大,结构混乱,难以维护
+ 微内核
  > 只把基本的功能保留在内核
  + 优点:内核功能少,结构清晰,方便维护
  + 缺点:需要频繁地在核心态和用户态之间切换,性能低

## 小结
![](assets/Screenshot%202022-02-08%20194513.png)

## 中断机制的诞生
> 早期的计算机,各程序只能串行执行,系统资源利用率低.  
> 为了解决这个问题,人们发明了操作系统(作为计算机制管理者),引入中断机制,实现了多道程序并发执行.  
> 本质:发生中断就意味着需要操作系统介入,开展管理工作  
> 大概流程:在用户态下,CPU收到计时部件发出的中断信号,切换为核心态对中断进行处理.操作系统内核负责对中断信号进行处理,如,进程1的时间片已用完,换进程2运行,进程2运行一段时间之后,发出系统调用(内中断信号),请求输出.CPU切换为核心态,对中断进行处理.之后,操作系统接管完成输出.

## 中断的概念和作用
1. 当中断发生时,CPU立即进入核心态
2. 当中断发生后,当前运行的进程暂停运行,并由操作系统内核对中断进行处理
3. 对于不同的中断信号,会进行不同的处理
> 发生了中断,就意味着需要操作系统介入,开展管理工作.由于操作系统的管理工作(比如进程切换,分配I/O设备等)需要使用特权指令,因此CPU要从用户态转为核心态.中断可以使CPU从用户态切换为核心态,使操作系统获得计算机的控制权.有了中断,才能实现多道程序并发执行.  
> "用户态->核心态"是通过中断实现的.并且中断是唯一途径.  
> "核心态->用户态"的切换是通过执行一个特权指令,将程序状态字(PSW)的标志位设置为"用户态"

## 中断的分类
+ 第一种分类
  ![](assets/Screenshot%202022-02-08%20211706.png)
+ 第二种分类
  ![](assets/Screenshot%202022-02-08%20211957.png)

## 外中断的处理过程
![](assets/Screenshot%202022-02-08%20212415.png)

## 小结
![](assets/Screenshot%202022-02-08%20212646.png)

## 系统调用
> 应用程序通过系统调用请求操作系统的服务.系统中的各种共享资源都由操作系统统一掌管,因此在用户程序中,凡是与资源有关的操作(如存储分配,I/O操作,文件管理等),都必须通过系统调用的方式向操作系统提出服务请求,由操作系统代为完成.这样可以保证系统的稳定性和安全性,防止用户进行非法操作.
> ![](assets/Screenshot%202022-02-09%20191226.png)

## 系统调用与库函数的区别
![](assets/Screenshot%202022-02-09%20191856.png)

## 系统调用的过程
![](assets/Screenshot%202022-02-09%20192904.png)

## 小结
![](assets/Screenshot%202022-02-09%20193206.png)











